(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}})();const l="https://api.seu-dominio.workers.dev/api";let s=null,a=null;async function p(r){try{const t=await fetch(`${l}/validate-team`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({team_code:r})});if(!t.ok)throw new Error("Código de equipe inválido");const n=await t.json();localStorage.setItem("token",n.token),localStorage.setItem("team_code",r),document.getElementById("login-container").classList.add("hidden"),document.getElementById("map-container").classList.remove("hidden"),u(),m()}catch(t){alert(t.message)}}function d(){localStorage.removeItem("token"),localStorage.removeItem("team_code"),s&&(s.remove(),s=null),document.getElementById("map-container").classList.add("hidden"),document.getElementById("login-container").classList.remove("hidden")}function u(){s||(s=L.map("map").setView([-23.55052,-46.633308],12),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(s),a=L.layerGroup().addTo(s))}async function m(){try{const r=localStorage.getItem("token");if(!r){d();return}const t=await fetch(`${l}/orders`,{headers:{Authorization:`Bearer ${r}`}});if(!t.ok){if(t.status===401){d();return}throw new Error("Erro ao carregar ordens de serviço")}const n=await t.json();f(n)}catch(r){alert(r.message)}}function f(r){if(!s||!a)return;a.clearLayers(),L.geoJSON(r,{pointToLayer:(n,i)=>{const o=n.properties.status==="pendente"?"red":"green";return L.circleMarker(i,{radius:8,fillColor:o,color:"#fff",weight:1,opacity:1,fillOpacity:.8})},onEachFeature:(n,i)=>{const e=n.properties;i.bindPopup(`
                <strong>OS:</strong> ${e.ordem_servico}<br>
                <strong>Status:</strong> ${e.status}<br>
                <strong>Equipe:</strong> ${e.equipe}
            `)}}).addTo(a);const t=a.getBounds();t.isValid()&&s.fitBounds(t)}document.getElementById("login-form").addEventListener("submit",r=>{r.preventDefault();const t=document.getElementById("team-code").value;p(t)});document.getElementById("logout-btn").addEventListener("click",d);const g=localStorage.getItem("token");g&&(document.getElementById("login-container").classList.add("hidden"),document.getElementById("map-container").classList.remove("hidden"),u(),m());
//# sourceMappingURL=index-CSRZCHDn.js.map
